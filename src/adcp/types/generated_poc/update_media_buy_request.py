# generated by datamodel-codegen:
#   filename:  update-media-buy-request.json
#   timestamp: 2025-11-15T17:41:32+00:00

from __future__ import annotations

from enum import Enum
from typing import Any

from adcp.types.base import AdCPBaseModel
from pydantic import AnyUrl, AwareDatetime, ConfigDict, Field, RootModel


class StartTiming(RootModel[str | AwareDatetime]):
    root: str | AwareDatetime = Field(
        ..., description="Campaign start timing: 'asap' or ISO 8601 date-time", title='Start Timing'
    )


class Pacing(Enum):
    even = 'even'
    asap = 'asap'
    front_loaded = 'front_loaded'


class GeoCountryAnyOfItem(RootModel[str]):
    root: str = Field(..., pattern='^[A-Z]{2}$')


class FrequencyCap(AdCPBaseModel):
    model_config = ConfigDict(
        extra='forbid',
    )
    suppress_minutes: float = Field(..., description='Minutes to suppress after impression', ge=0.0)


class Scheme(Enum):
    Bearer = 'Bearer'
    HMAC_SHA256 = 'HMAC-SHA256'


class Authentication(AdCPBaseModel):
    model_config = ConfigDict(
        extra='forbid',
    )
    schemes: list[Scheme] = Field(
        ...,
        description="Array of authentication schemes. Supported: ['Bearer'] for simple token auth, ['HMAC-SHA256'] for signature verification (recommended for production)",
        max_length=1,
        min_length=1,
    )
    credentials: str = Field(
        ...,
        description='Credentials for authentication. For Bearer: token sent in Authorization header. For HMAC-SHA256: shared secret used to generate signature. Minimum 32 characters. Exchanged out-of-band during onboarding.',
        min_length=32,
    )


class PushNotificationConfig(AdCPBaseModel):
    model_config = ConfigDict(
        extra='forbid',
    )
    url: AnyUrl = Field(..., description='Webhook endpoint URL for task status notifications')
    token: str | None = Field(
        None,
        description='Optional client-provided token for webhook validation. Echoed back in webhook payload to validate request authenticity.',
        min_length=16,
    )
    authentication: Authentication = Field(
        ..., description='Authentication configuration for webhook delivery (A2A-compatible)'
    )


class Targeting(AdCPBaseModel):
    model_config = ConfigDict(
        extra='forbid',
    )
    geo_country_any_of: list[GeoCountryAnyOfItem] | None = Field(
        None,
        description='Restrict delivery to specific countries (ISO codes). Use for regulatory compliance or RCT testing.',
    )
    geo_region_any_of: list[str] | None = Field(
        None,
        description='Restrict delivery to specific regions/states. Use for regulatory compliance or RCT testing.',
    )
    geo_metro_any_of: list[str] | None = Field(
        None,
        description='Restrict delivery to specific metro areas (DMA codes). Use for regulatory compliance or RCT testing.',
    )
    geo_postal_code_any_of: list[str] | None = Field(
        None,
        description='Restrict delivery to specific postal/ZIP codes. Use for regulatory compliance or RCT testing.',
    )
    axe_include_segment: str | None = Field(
        None, description='AXE segment ID to include for targeting'
    )
    axe_exclude_segment: str | None = Field(
        None, description='AXE segment ID to exclude from targeting'
    )
    frequency_cap: FrequencyCap | None = None


class Packages(AdCPBaseModel):
    model_config = ConfigDict(
        extra='forbid',
    )
    package_id: str = Field(..., description="Publisher's ID of package to update")
    buyer_ref: str | None = Field(None, description="Buyer's reference for the package to update")
    budget: float | None = Field(
        None,
        description='Updated budget allocation for this package in the currency specified by the pricing option',
        ge=0.0,
    )
    pacing: Pacing | None = None
    bid_price: float | None = Field(
        None,
        description='Updated bid price for auction-based pricing options (only applies when pricing_option is auction-based)',
        ge=0.0,
    )
    active: bool | None = Field(None, description='Pause/resume specific package')
    targeting_overlay: Targeting | None = None
    creative_ids: list[str] | None = Field(None, description='Update creative assignments')


class Packages1(AdCPBaseModel):
    model_config = ConfigDict(
        extra='forbid',
    )
    package_id: str | None = Field(None, description="Publisher's ID of package to update")
    buyer_ref: str = Field(..., description="Buyer's reference for the package to update")
    budget: float | None = Field(
        None,
        description='Updated budget allocation for this package in the currency specified by the pricing option',
        ge=0.0,
    )
    pacing: Pacing | None = None
    bid_price: float | None = Field(
        None,
        description='Updated bid price for auction-based pricing options (only applies when pricing_option is auction-based)',
        ge=0.0,
    )
    active: bool | None = Field(None, description='Pause/resume specific package')
    targeting_overlay: Targeting | None = None
    creative_ids: list[str] | None = Field(None, description='Update creative assignments')


class UpdateMediaBuyRequest1(AdCPBaseModel):
    model_config = ConfigDict(
        extra='forbid',
    )
    media_buy_id: str = Field(..., description="Publisher's ID of the media buy to update")
    buyer_ref: str | None = Field(None, description="Buyer's reference for the media buy to update")
    active: bool | None = Field(None, description='Pause/resume the entire media buy')
    start_time: StartTiming | None = None
    end_time: AwareDatetime | None = Field(None, description='New end date/time in ISO 8601 format')
    packages: list[Packages | Packages1] | None = Field(
        None, description='Package-specific updates'
    )
    push_notification_config: PushNotificationConfig | None = Field(
        None,
        description='Optional webhook configuration for async update notifications. Publisher will send webhook when update completes if operation takes longer than immediate response time.',
    )
    context: dict[str, Any] | None = Field(
        None,
        description='Initiator-provided context included in the request payload. Agents must echo this value back unchanged in responses and webhooks. Use for UI/session hints, correlation tokens, or tracking metadata.',
    )


class Packages2(AdCPBaseModel):
    model_config = ConfigDict(
        extra='forbid',
    )
    package_id: str = Field(..., description="Publisher's ID of package to update")
    buyer_ref: str | None = Field(None, description="Buyer's reference for the package to update")
    budget: float | None = Field(
        None,
        description='Updated budget allocation for this package in the currency specified by the pricing option',
        ge=0.0,
    )
    pacing: Pacing | None = None
    bid_price: float | None = Field(
        None,
        description='Updated bid price for auction-based pricing options (only applies when pricing_option is auction-based)',
        ge=0.0,
    )
    active: bool | None = Field(None, description='Pause/resume specific package')
    targeting_overlay: Targeting | None = None
    creative_ids: list[str] | None = Field(None, description='Update creative assignments')


class Packages3(AdCPBaseModel):
    model_config = ConfigDict(
        extra='forbid',
    )
    package_id: str | None = Field(None, description="Publisher's ID of package to update")
    buyer_ref: str = Field(..., description="Buyer's reference for the package to update")
    budget: float | None = Field(
        None,
        description='Updated budget allocation for this package in the currency specified by the pricing option',
        ge=0.0,
    )
    pacing: Pacing | None = None
    bid_price: float | None = Field(
        None,
        description='Updated bid price for auction-based pricing options (only applies when pricing_option is auction-based)',
        ge=0.0,
    )
    active: bool | None = Field(None, description='Pause/resume specific package')
    targeting_overlay: Targeting | None = None
    creative_ids: list[str] | None = Field(None, description='Update creative assignments')


class UpdateMediaBuyRequest2(AdCPBaseModel):
    model_config = ConfigDict(
        extra='forbid',
    )
    media_buy_id: str | None = Field(None, description="Publisher's ID of the media buy to update")
    buyer_ref: str = Field(..., description="Buyer's reference for the media buy to update")
    active: bool | None = Field(None, description='Pause/resume the entire media buy')
    start_time: StartTiming | None = None
    end_time: AwareDatetime | None = Field(None, description='New end date/time in ISO 8601 format')
    packages: list[Packages2 | Packages3] | None = Field(
        None, description='Package-specific updates'
    )
    push_notification_config: PushNotificationConfig | None = Field(
        None,
        description='Optional webhook configuration for async update notifications. Publisher will send webhook when update completes if operation takes longer than immediate response time.',
    )
    context: dict[str, Any] | None = Field(
        None,
        description='Initiator-provided context included in the request payload. Agents must echo this value back unchanged in responses and webhooks. Use for UI/session hints, correlation tokens, or tracking metadata.',
    )


class UpdateMediaBuyRequest(RootModel[UpdateMediaBuyRequest1 | UpdateMediaBuyRequest2]):
    root: UpdateMediaBuyRequest1 | UpdateMediaBuyRequest2 = Field(
        ...,
        description='Request parameters for updating campaign and package settings',
        title='Update Media Buy Request',
    )
